 <!DOCTYPE html>
<html>
<body>
 <script>

  
 <script>

  /**
 * encode via diacritics
 */
function encode() {
 string=document.getElementById("basetext").value//.normalize("NFD")
 hiddenstring=document.getElementById("hiddentext").value//.normalize("NFD")
 
 //Convert hidden text to array of bytes
 const codeUnits = new Uint16Array(hiddenstring.length);
 i=0;
 for (let codePoint of hiddenstring) {
   //console.log(codePoint.codePointAt(0));
   codeUnits[i++] =codePoint.codePointAt(0);
} 
  const charCodes = new Uint8Array(codeUnits.buffer);

 
  // Use the Unicode block for combining diacritics.
  // https://en.wikipedia.org/wiki/Combining_Diacritical_Marks
  const blockRangeMin = 0x0300

  // Build up a list of letters.
  let result = "";
  var chararray = [];
  let k=0
  for (let i = 0; i < charCodes.byteLength; i++) {
     chararray[i]=charCodes[i];
     const quotient = Math.floor(charCodes[i]/112);
     const remainder = charCodes[i] % 112;
     //console.log(quotient);
     //console.log(remainder);
     const codePoint1 = blockRangeMin+quotient;
     const codePoint2 = blockRangeMin+remainder;
     if (k < string.length){
       result +=string.charAt(k++);
     }else{
       result+='a';
     }
     result += String.fromCodePoint(codePoint1);
     if (k < string.length){
       result +=string.charAt(k++);
     }else{
       result+='a';
     }
     result += String.fromCodePoint(codePoint2);
 }
   //console.log(chararray);
   //console.log(result.normalize("NFD").length);
 document.getElementById("combinedtext").value = result;
}

function decode(){
  const encodedtext=document.getElementById("combinedtext").value
  const normalized=encodedtext//.normalize("NFD")
  let hiddentext=''
  let basetext=''
  const codeUnits = new Uint16Array();
 let k=0;
 var chararray = [];
 let j=0;
 for (let i = 0; i < normalized.length; i++) {
        const numericCodePoint = normalized.codePointAt(i);
        //if (numericCodePoint !== normalized[i].codePointAt(0)) {
          // This is high/low surrogate. Skip the low surrogate.
          //i++;
        //}
    codeUnits[k++] =numericCodePoint;
    //console.log(numericCodePoint);
    if ( numericCodePoint <= 0x036F && numericCodePoint >= 0x0300){
      chararray[j++]=numericCodePoint-0x0300;
    }else{
    basetext+=normalized.charAt(i);
    }
}
  let bytes = new Uint8Array(chararray.length/2);
  j=0;
  for (let i=0; i<chararray.length;i+=2){
    charcode1 = chararray[i];
    charcode2 = chararray[i+1];
    bytes[j++]=charcode1*112+charcode2;
  }
  
  const charCodes = new Uint16Array(bytes.buffer);
  for (let i = 0; i < charCodes.length; i++) {
    hiddentext += String.fromCodePoint(charCodes[i]);
  }
  document.getElementById("basetext").value=basetext
  document.getElementById("hiddentext").value=hiddentext
//console.log(chararray);
//console.log(bytes);
}
  
</script>
 
<h1>StegaMark</h1>
 <p>This simple javascript program can be used to hide text/data within diacritics marks of Unicode. This is not an encryption by any means.</p>
 
<p>Text that will be the base to add hidden text. If the length is not enough, 'a' will be used.</p>
 <textarea id="basetext" name="basetext" rows="4" cols="50" onkeyup="encode(); return false;"></textarea>
  <br><br>
<p>Text that will be hidden within base text. This is the secret message that you want to send. Please encrypt, do not send plaintext.</p>
 <textarea id="hiddentext" name="hiddentext" rows="4" cols="50" onkeyup="encode(); return false;"></textarea>
  <br><br>
<p>Combined text. This is the combined, hidden and base text. In order to decode a message just paste your combined text here.</p>
 <textarea id="combinedtext" name="combinedtext" rows="4" cols="50" onkeyup="decode(); return false;"></textarea>
  <br><br>


</body>
</html> 
